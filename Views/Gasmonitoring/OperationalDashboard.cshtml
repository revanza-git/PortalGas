@using Admin.Models.Gasmon

@{
    Layout = "~/Views/Shared/Panel.cshtml";

    var target_pasokan = (Int32)ViewData["target_pasokan"];
    var realisasi_pasokan = (Decimal)ViewData["realisasi_pasokan"];
    var prosentase_pasokan = target_pasokan == 0 ? 0 : Math.Round(realisasi_pasokan * 100 / target_pasokan);
    var target_penjualan = (Int32)ViewData["target_penjualan"];
    var realisasi_penjualan = (Decimal)ViewData["realisasi_penjualan"];
    var realisasi_penjualan1 = (Decimal)ViewData["realisasi_penjualan1"];
    var realisasi_penjualan2 = (Decimal)ViewData["realisasi_penjualan2"];
    var realisasi_penjualan3 = (Decimal)ViewData["realisasi_penjualan3"];
    var realisasi_penjualan4 = (Decimal)ViewData["realisasi_penjualan4"];
    var prosentase_penjualan = target_penjualan == 0 ? 0 : Math.Round(realisasi_penjualan * 100 / target_penjualan);
    var jsonROB = Html.Raw(ViewData["jsonROB"]);
    var jsonBOG = Html.Raw(ViewData["jsonBOG"]);
    var jsonRegasRate = Html.Raw(ViewData["jsonRegasRate"]);
    var startDate = (DateTime) ViewData["StartDate"];
    var endDate = (DateTime)ViewData["EndDate"];

    var jsons = (String[]) ViewData["jsonDailyEnergy"];
    var json1 = Html.Raw(jsons[1]);
    var json2 = Html.Raw(jsons[2]);
    var json3 = Html.Raw(jsons[3]);
    var json4 = Html.Raw(jsons[4]);

    var orfData = (List<ORFData>)ViewData["orfData"];
    var orfDataDaily = (List<ORFDataDaily>)ViewData["orfDataDaily"];
    Decimal F1 = 0;
    Decimal C1 = 0;
    try
    {
        F1 = orfData.Where(x => x.LineID == 1).LastOrDefault().Temperature;
        C1 = (F1 - 32) / (Decimal)1.8;
    }
    catch (Exception)
    {}

    Decimal F2 = 0;
    Decimal C2 = 0;
    try
    {
        F2 = orfData.Where(x => x.LineID == 2).LastOrDefault().Temperature;
        C2 = (F2 - 32) / (Decimal)1.8;
    }
    catch (Exception)
    { }

    Decimal F3 = 0;
    Decimal C3 = 0;
    try
    {
        F3 = orfData.Where(x => x.LineID == 3).LastOrDefault().Temperature;
        C3 = (F3 - 32) / (Decimal)1.8;
    }
    catch (Exception)
    { }

    Decimal F4 = 0;
    Decimal C4 = 0;
    try
    {
        F4 = orfData.Where(x => x.LineID == 4).LastOrDefault().Temperature;
        C4 = (F4 - 32) / (Decimal)1.8;
    }
    catch (Exception)
    { }

    Decimal DailyEnergy1 = 0;
    Decimal DailyEnergy2 = 0;
    Decimal DailyEnergy3 = 0;
    Decimal DailyEnergy4 = 0;
    try
    {
        DailyEnergy1 = orfDataDaily.LastOrDefault(x => x.LineID == 1).DailyEnergy;
    }
    catch (Exception)
    { }
    try
    {
        DailyEnergy2 = orfDataDaily.LastOrDefault(x => x.LineID == 2).DailyEnergy;
    }
    catch (Exception)
    { }
    try
    {
        DailyEnergy3 = orfDataDaily.LastOrDefault(x => x.LineID == 3).DailyEnergy;
    }
    catch (Exception)
    { }
    try
    {
        DailyEnergy4 = orfDataDaily.LastOrDefault(x => x.LineID == 4).DailyEnergy;
    }
    catch (Exception)
    { }

    Decimal HeatingValue1 = 0;
    Decimal HeatingValue2 = 0;
    Decimal HeatingValue3 = 0;
    Decimal HeatingValue4 = 0;
    try
    {
        HeatingValue1 = orfDataDaily.LastOrDefault(x => x.LineID == 1).HeatingValue;
    }
    catch (Exception)
    { }

    try
    {
        HeatingValue2 = orfDataDaily.LastOrDefault(x => x.LineID == 2).HeatingValue;
    }
    catch (Exception)
    { }

    try
    {
        HeatingValue3 = orfDataDaily.LastOrDefault(x => x.LineID == 3).HeatingValue;
    }
    catch (Exception)
    { }

    try
    {
        HeatingValue4 = orfDataDaily.LastOrDefault(x => x.LineID == 4).HeatingValue;
    }
    catch (Exception)
    { }

    Decimal Psig1 = 0;
    Decimal Psig2 = 0;
    Decimal Psig3 = 0;
    Decimal Psig4 = 0;
    Decimal Barg1 = 0;
    Decimal Barg2 = 0;
    Decimal Barg3 = 0;
    Decimal Barg4 = 0;

    try
    {
        Psig1 = orfDataDaily.LastOrDefault(x => x.LineID == 1).Pressure;
        Barg1 = Psig1 / (Decimal)14.5;
    }
    catch (Exception)
    { }

    try
    {
        Psig2 = orfDataDaily.LastOrDefault(x => x.LineID == 2).Pressure;
        Barg2 = Psig2 / (Decimal)14.5;
    }
    catch (Exception)
    { }

    try
    {
        Psig3 = orfDataDaily.LastOrDefault(x => x.LineID == 3).Pressure;
        Barg3 = Psig3 / (Decimal)14.5;
    }
    catch (Exception)
    { }

    try
    {
        Psig4 = orfDataDaily.LastOrDefault(x => x.LineID == 4).Pressure;
        Barg4 = Psig4 / (Decimal)14.5;
    }
    catch (Exception)
    { }
}

@section PageLevelPlugin {
    <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
    <link rel="stylesheet" href="~/admin/vendor/bootstrap-daterangepicker/daterangepicker-bs3.css" />

    <style>
        #chartdiv {
            width: 100%;
            height: 350px;
        }

        #chartdiv2, #chartdiv3, #chartdiv4, #chartdiv5, #chartdiv6 {
            width: 100%;
            height: 500px;
        }
    </style>
}

@section TitleBar {
    <strong>Gas Monitoring</strong>
}

<!-- main area -->
<div class="main-content">
    <div class="panel">
        <div class="panel-heading border">
            <ol class="breadcrumb mb0 no-padding">
                <li>
                    <a href="javascript:;">Content</a>
                </li>
                <li>
                    <a href="javascript:;">Gas Monitoring</a>
                </li>
                <li class="active"><strong>Operational Dashboard</strong></li>
            </ol>
        </div>
        <div class="panel-body">
            @if (TempData["message"] != null)
            {
                <div class="alert alert-success"><i class="fa fa-lg fa-check-circle"></i> @TempData["message"]</div>
            }
            <div class="row">
                <div class="col-md-3">
                    Year: 
                    <select onchange="updateDashboards(this.value)">
                        @for (Int32 year = DateTime.Now.Year; year >= 2012; year--)
                        {
                            <option value="@year">@year</option>
                        }
                    </select>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-6">
                    <section class="widget bg-success text-center bold">
                        <div class="widget-details col-xs-6">
                            <h2 class="no-margin" id="rkap"><b><label id="target_pasokan">@target_pasokan</label> Cargo</b></h2>
                            <small class="text-uppercase" style="font-size:15px;"><b>RKAP</b></small>
                        </div>
                        <div class="widget-details col-xs-6">
                            <h2 class="no-margin" id="realisasi"><b><label id="realisasi_pasokan">@realisasi_pasokan.ToString("N0")</label> Cargo</b></h2>
                            <small class="text-uppercase" style="font-size:15px;"><b>REALISASI</b></small>
                        </div>
                    </section>
                </div>
                <div class="col-md-6">
                    <section class="widget bg-warning text-center">
                        <div class="widget-details col-xs-12">
                            <h2 class="no-margin"><b><label id="realisasi_penjualan">@realisasi_penjualan.ToString("N0")</label> MMBTU</b></h2>
                            <small class="text-uppercase" style="font-size:15px;"><b>TOTAL GAS SENT</b></small>
                        </div>
                    </section>
                </div>
                <div class="row">
                    <div class="col-md-6" style="text-align:center">

                        <div id="chartdiv"></div>
                    </div>

                    <div class="col-md-6">
                        <div class="widget-chart bg-white">
                            <div class="canvas-holder mt5 mb5">
                                <div class="flot-pie chart-sm" style="height:250px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="widget bg-danger">
                            <div class="widget-icon bg-white pull-left fa fa-tachometer">
                            </div>
                            <div class="overflow-hidden">
                                <span class="widget-title" style="font-weight:bold; color: white">
                                    LINE 350 MK
                                </span>
                                <span class="widget-subtitle" style="font-weight:bold; color: white">
                                    @DailyEnergy1.ToString("N0") MMBTUD<br />
                                    @HeatingValue1.ToString("N0") BTU/SCF<br />
                                    @Psig1.ToString("N0") Psig (@Barg1.ToString("N0") Barg)<br />
                                    @F1.ToString("N0") <sup>o</sup>F (@C1.ToString("N0") <sup>o</sup>C)<br />
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget bg-blue">
                            <div class="widget-icon bg-white pull-left fa fa-tachometer">
                            </div>
                            <div class="overflow-hidden">
                                <span class="widget-title" style="font-weight:bold; color: white">LINE 620 MK</span>
                                <span class="widget-subtitle" style="font-weight:bold; color: white">
                                    @DailyEnergy2.ToString("N0") MMBTUD<br />
                                    @HeatingValue2.ToString("N0") BTU/SCF<br />
                                    @Psig2.ToString("N0") Psig (@Barg2.ToString("N0") Barg)<br />
                                    @F2.ToString("N0") <sup>o</sup>F (@C2.ToString("N0") <sup>o</sup>C)<br />
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget bg-warning">
                            <div class="widget-icon bg-white pull-left fa fa-tachometer">
                            </div>
                            <div class="overflow-hidden">
                                <span class="widget-title" style="font-weight:bold; color: white">LINE 350 MK</span>
                                <span class="widget-subtitle" style="font-weight:bold; color: white">
                                    @DailyEnergy3.ToString("N0") MMBTUD<br />
                                    @HeatingValue3.ToString("N0") BTU/SCF<br />
                                    @Psig3.ToString("N0") Psig (@Barg3.ToString("N0") Barg)<br />
                                    @F3.ToString("N0") <sup>o</sup>F (@C3.ToString("N0") <sup>o</sup>C)<br />
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget bg-success">
                            <div class="widget-icon bg-white pull-left fa fa-tachometer">
                            </div>
                            <div class="overflow-hidden">
                                <span class="widget-title" style="font-weight:bold; color: white">PERTAGAS</span>
                                <span class="widget-subtitle" style="font-weight:bold; color: white">
                                    @DailyEnergy4.ToString("N0") MMBTUD<br />
                                    @HeatingValue4.ToString("N0") BTU/SCF<br />
                                    @Psig4.ToString("N0") Psig (@Barg4.ToString("N0") Barg)<br />
                                    @F4.ToString("N0") <sup>o</sup>F (@C4.ToString("N0") <sup>o</sup>C)<br />
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="chartdiv2"></div>
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-md-3">
                        Period:
                        <div class="input-prepend input-group">
                            <span class="add-on input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" name="daterange" class="form-control drp" value="@startDate.ToString("dd/MM/yyyy") - @endDate.ToString("dd/MM/yyyy")" onchange="updateGraphs(this.value)"/>
                        </div>
                     </div>                   
                </div>
                <div class="row">
                    <div class="col-md-12">                        
                        <div id="chartdiv3"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="chartdiv4"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="chartdiv5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /main area -->

@section PageLevelScripts {
    <!-- Resources -->
    <script src="~/admin/vendor/amcharts_3.21.12/amcharts/amcharts.js"></script>
    <script src="~/admin/vendor/amcharts_3.21.12/amcharts/gauge.js"></script>
    <script src="~/admin/vendor/amcharts_3.21.12/amcharts/plugins/export/export.min.js"></script>
    <script src="~/admin/vendor/amcharts_3.21.12/amcharts/themes/light.js"></script>
    <script src="~/admin/vendor/amcharts_3.21.12/amcharts/serial.js"></script>
    <script src="https://www.amcharts.com/lib/3/amstock.js"></script>
    <script src="~/admin/vendor/flot/jquery.flot.js"></script>
    <script src="~/admin/vendor/flot/jquery.flot.categories.js"></script>
    <script src="~/admin/vendor/flot/jquery.flot.resize.js"></script>
    <script src="~/admin/vendor/flot/jquery.flot.pie.js"></script>
    <script src="~/admin/vendor/moment/moment.js"></script>
    <script src="~/admin/vendor/bootstrap-daterangepicker/daterangepicker.js"></script>
    <script src="~/admin/scripts/OperationalDashboard.js"></script>
}